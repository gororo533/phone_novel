<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">

  <title>Novel</title>

  <link href="https://fonts.googleapis.com/css?family=Faster+One" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <link rel="icon" href="fainsh.png">
</head>

<body>
  <div class="menuout">
    <div class="asideMenu" id="asideMenu">
      <button class="btn" id="hi"></button>
      <div class="title">Aside Menu</div>
      <div class="list">
        <ul class="optionTitle">
          <li>Font size</li>
          <div class="col">
            字型大小：
            <select class="sele" onchange="fzchange(this.options[this.selectedIndex].value);">
              <option value="8">8</option>
              <option value="10">10</option>
              <option value="12">12</option>
              <option value="14">14</option>
              <option value="16">16</option>
              <option value="20">20</option>
            </select>
          </div>
          <li>Jump to</li>
          <div class="col">
            <input id="input1">
            <button id="sentpage">sent</button>
            <select class="sele" id="pagechangeid" onchange="pagechange(this.options[this.selectedIndex].value);">
              
            </select>
          </div>
          <li>Font family</li>
          <div class="col">
            字體：
            <select class="sele" onchange="fmchange(this.options[this.selectedIndex].value);">
              <option value="DFKai-SB">標楷體</option>
              <option value="PMingLiU">新細明體</option>
              <option value="Microsoft JhengHei">微軟正黑體</option>
            </select>
          </div>
        </ul>
      </div>
    </div>
  </div>
  <section class="sec" id="sec">

  </section>
  <button id="previous">Previous </button>
  <span id="pageeee"></span>
  <button id="next">Next</button>

  <script>
    let pagechangeid = document.getElementById("pagechangeid");
    
    let btn = document.getElementById("hi");
    btn.addEventListener("click", function () {
      document.getElementById("asideMenu").classList.toggle("active");
      btn.classList.toggle("active");
    })

    let page = 1;
    let fontsize = 14;
    let fontfamily = "DFKai-SB";
    let next = document.getElementById("next");
    next.addEventListener("click", function () {
      page += 1;
      populate(page);
    })

    let previous = document.getElementById("previous");
    previous.addEventListener("click", function () {
      if (page !== 0) {
        page -= 1;
        populate(page);
      }
      else alert("you can't do it ");
    })

    function fzchange(x) {
      let chagefz = document.querySelectorAll("p");
      for (i of chagefz) {
        i.style.fontSize = `${x}px`;
        i.style.lineHeight = `${Number(x) * 2}px`;
      }
      fontsize = Number(x);
    }
    function fmchange(x) {
      let chagefz = document.querySelectorAll("p");
      for (i of chagefz) {
        i.style.fontFamily  =  `${x}`;
      }
      let h1 = document.querySelector("h1");
      h1.style.fontFamily  = `${x}`;
      fontfamily = x;
    }
    
    function pagechange(x){
      page = Number(x);
      document.getElementById("asideMenu").classList.toggle("active");
      btn.classList.toggle("active");
      populate(page);
    }

    let sentpage = document.getElementById("sentpage");
    sentpage.addEventListener("click", function () {
      let input1 = document.getElementById("input1");
      if (!isNaN(input1.value)) {
        page = parseInt(input1.value, 10);
        document.getElementById("asideMenu").classList.toggle("active");
        btn.classList.toggle("active");
        populate(page);
      }
      else {
        alert("only number!!!");
      }
      input1.value = "";
    })

    async function populate(a) {
      console.log(a);
      let b = `https://gororo533.github.io/data/${a}.json`
      const requestURL = b;
      const request = new Request(requestURL);
      const response = await fetch(request);
      const superHeroes = await response.json();
      populateHeroes(superHeroes);
    }


    function populateHeroes(obj) {
      const section = document.querySelector('section');

      /*for (i of obj) {
        console.log(i)
      }*/
      section.innerHTML = `<h1>${obj[0]}</h1>`;
      for (let x = 1; x < obj.length; x++) {

        i = obj[x]
        const myPara = document.createElement('p');
        myPara.innerHTML = `${i}`
        section.appendChild(myPara);
      }
      document.getElementById("pageeee").innerHTML = `P.${page}`;
      window.scrollTo(0, 0);
      fmchange(fontfamily);
      fzchange(`${fontsize}`);
      console.log(fontfamily ,fontsize);
      /*for(let i = 1;i<1450;i++){
        pagechangeid.innerHTML+=`<option value="${i}">${i}</option>`;
      }*/
    }
    populate(1);

    async function titles() {
      const requestURL = `https://gororo533.github.io/data/titles.json`;
      const request = new Request(requestURL);
      const response = await fetch(request);
      const superHeroes = await response.json();
      titletoselect(superHeroes);
    }
    function titletoselect(a){
      for(let i = 0 , h = 1;i<1447;i++){
        if(i === 135)h++;
        if(i === 579)h++;
        if(i === 888)h++;
        if(i === 976)h++;
        if(i === 1304 || i === 1394 ){
          h--;
          continue;
        }
        pagechangeid.innerHTML+=`<option value="${i+h}">${a[i]}</option>`;
      }
    }
    window.addEventListener("load" , function(){
      titles(); 
    })
  </script>
</body>

</html>